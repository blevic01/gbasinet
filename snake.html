<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake - GBASIMET</title>
<style>
body{ text-align:center; margin:0; background-image:url('https://wallpaperaccess.com/full/3175017.jpg'); background-size:cover; color:white; font-family:Arial;}
canvas{ background:black; display:block; margin:20px auto;}
button, select{ margin:5px; padding:10px 20px; font-size:16px; border-radius:10px; cursor:pointer; background-color:rgba(0,0,0,0.7); color:white; border:none;}
button:hover, select:hover{ background-color:rgba(255,0,0,0.8);}
#controls{ display:grid; grid-template-columns: 80px 80px 80px; justify-content:center; margin-top:10px; }
#up{ grid-column: 2; }
#left{ grid-column:1; }
#right{ grid-column:3; }
#down{ grid-column:2; }
</style>
</head>
<body>
<h1>Snake Game</h1>

<label for="level">Select Level:</label>
<select id="level">
  <option value="1">Level 1</option>
  <option value="2">Level 2</option>
  <option value="3">Level 3</option>
  <option value="4">Level 4</option>
  <option value="5">Level 5</option>
  <option value="6">Level 6</option>
  <option value="7">Level 7</option>
  <option value="8">Level 8</option>
  <option value="9">Level 9</option>
  <option value="10">Level 10</option>
</select>

<label for="speed">Select Speed:</label>
<select id="speed">
  <option value="200">Super Slow</option>
  <option value="150">Slow</option>
  <option value="100" selected>Medium</option>
  <option value="70">Fast</option>
  <option value="50">Super Fast</option>
</select>

<canvas id="canvas" width="400" height="400"></canvas>
<p id="score">Score: 0 | Level: 1</p>

<div id="controls">
  <div></div>
  <button id="up">↑</button>
  <div></div>
  <button id="left">←</button>
  <button id="down">↓</button>
  <button id="right">→</button>
</div>

<button onclick="startGame()">Restart</button>
<button onclick="window.location.href='games.html'">Back to Games</button>

<script>
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');
const box=20;
let snake=[], food, score, dir, gameInterval, obstacles=[], level=1, speed=100;
let eatSound = new Audio("https://www.soundjay.com/button/sounds/button-16.mp3");

// On-screen controls
document.getElementById('up').onclick=()=>{ if(dir!=='DOWN') dir='UP'; };
document.getElementById('down').onclick=()=>{ if(dir!=='UP') dir='DOWN'; };
document.getElementById('left').onclick=()=>{ if(dir!=='RIGHT') dir='LEFT'; };
document.getElementById('right').onclick=()=>{ if(dir!=='LEFT') dir='RIGHT'; };

// Keyboard controls
document.addEventListener('keydown',e=>{
    if(e.key==='ArrowUp' && dir!=='DOWN') dir='UP';
    else if(e.key==='ArrowDown' && dir!=='UP') dir='DOWN';
    else if(e.key==='ArrowLeft' && dir!=='RIGHT') dir='LEFT';
    else if(e.key==='ArrowRight' && dir!=='LEFT') dir='RIGHT';
});

function startGame(){
    clearInterval(gameInterval);
    level=parseInt(document.getElementById('level').value);
    speed=parseInt(document.getElementById('speed').value);
    snake=[{x:9*box,y:10*box}];
    dir='RIGHT';
    score=0; document.getElementById('score').textContent=`Score: 0 | Level: ${level}`;
    generateObstacles(level);
    placeFood();
    gameInterval=setInterval(draw,speed);
}

// Place food in random position avoiding snake and obstacles
function placeFood(){
    while(true){
        let x=Math.floor(Math.random()*20)*box;
        let y=Math.floor(Math.random()*20)*box;
        if(!snake.some(s=>s.x===x && s.y===y) && !obstacles.some(o=>o.x===x && o.y===y)){
            food={x,y}; break;
        }
    }
}

// Create obstacles depending on level
function generateObstacles(level){
    obstacles=[];
    for(let i=0;i<level*2;i++){ // number of obstacles = level*2
        let x=Math.floor(Math.random()*20)*box;
        let y=Math.floor(Math.random()*20)*box;
        if(!snake.some(s=>s.x===x && s.y===y)) obstacles.push({x,y});
    }
}

function draw(){
    ctx.fillStyle='black'; ctx.fillRect(0,0,canvas.width,canvas.height);
    // Draw snake
    snake.forEach(s=>{ ctx.fillStyle='lime'; ctx.fillRect(s.x,s.y,box,box); });
    // Draw food
    ctx.fillStyle='red'; ctx.fillRect(food.x,food.y,box,box);
    // Draw obstacles
    ctx.fillStyle='gray';
    obstacles.forEach(o=>ctx.fillRect(o.x,o.y,box,box));

    // Move snake
    let head={x:snake[0].x, y:snake[0].y};
    if(dir==='RIGHT') head.x+=box;
    if(dir==='LEFT') head.x-=box;
    if(dir==='UP') head.y-=box;
    if(dir==='DOWN') head.y+=box;

    // Collision with walls or self or obstacles
    if(head.x<0 || head.x>=canvas.width || head.y<0 || head.y>=canvas.height || 
       snake.some(s=>s.x===head.x && s.y===head.y) ||
       obstacles.some(o=>o.x===head.x && o.y===head.y)){
        alert(`Game Over! Score: ${score}`);
        startGame(); return;
    }

    snake.unshift(head);

    if(head.x===food.x && head.y===food.y){
        score++; document.getElementById('score').textContent=`Score: ${score} | Level: ${level}`;
        eatSound.play();
        placeFood();
    }else snake.pop();

    document.getElementById('score').textContent=`Score: ${score} | Level: ${level}`;
}
</script>
</body>
</html>